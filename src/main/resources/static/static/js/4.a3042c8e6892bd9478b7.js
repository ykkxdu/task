webpackJsonp([4],{Huex:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"任务名称"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.query(e)}},model:{value:t.searchForm.taskName,callback:function(e){t.$set(t.searchForm,"taskName",e)},expression:"searchForm.taskName"}})],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-button",{attrs:{loading:t.loading,icon:"el-icon-search"},on:{click:t.query}},[t._v("搜索")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.handleCreate}},[t._v("添加")])],1)],1),t._v(" "),a("el-table",{attrs:{data:t.blueLabel.children,"element-loading-text":"拼命加载中",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"序号",width:"100",type:"index"}}),t._v(" "),a("el-table-column",{attrs:{label:"任务名称","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.taskName)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"任务内容","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.taskContent)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"完成时间","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.finishTime)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"任务状态","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.taskStatus)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"检查人","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.taskPerson)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){t.handleUpdate(e.row)}}},[a("i",{staticClass:"el-icon-edit"})]),t._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(a){t.openHandleDelete(e.row)}}},[a("i",{staticClass:"el-icon-delete"})])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"inspectionTaskForm",staticClass:"small-space",staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:t.formData,"label-position":"right","label-width":"120px"}},[a("el-form-item",{attrs:{label:"任务名称",prop:"taskName",rules:[{required:!0,message:"任务名称不能为空"}]}},[a("el-input",{model:{value:t.formData.taskName,callback:function(e){t.$set(t.formData,"taskName",e)},expression:"formData.taskName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"任务內容",prop:"taskContent",rules:[{required:!0,message:"任务內容不能为空"}]}},[a("el-input",{model:{value:t.formData.taskContent,callback:function(e){t.$set(t.formData,"taskContent",e)},expression:"formData.taskContent"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"完成时间",prop:"finishTime",rules:[{required:!0,message:"完成时间不能为空"}]}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",editable:""},model:{value:t.formData.finishTime,callback:function(e){t.$set(t.formData,"finishTime",e)},expression:"formData.finishTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"任务状态",prop:"taskStatus",rules:[{required:!0,message:"任务状态不能为空"}]}},[a("el-select",{attrs:{placeholder:"未完成"},model:{value:t.formData.taskStatus,callback:function(e){t.$set(t.formData,"taskStatus",e)},expression:"formData.taskStatus"}},t._l(t.taskStatusOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"检查人",prop:"taskPerson",rules:[{required:!0,message:"检查人不能为空"}]}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formData.taskPerson,callback:function(e){t.$set(t.formData,"taskPerson",e)},expression:"formData.taskPerson"}},t._l(t.checkPersonOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.create}},[t._v("确定")]):a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.update}},[t._v("确定")])],1)],1)],1)},s=[],i={render:n,staticRenderFns:s};e.a=i},NJna:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,".el-tooltip__popper{max-width:40vw!important}",""])},NydZ:function(t,e,a){var n=a("NJna");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("52ea329c",n,!0)},kiFj:function(t,e,a){"use strict";function n(t){a("NydZ")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("uktu"),i=a("Huex"),l=a("VU/8"),o=n,r=l(s.a,i.a,o,null,null);e.default=r.exports},uktu:function(t,e,a){"use strict";var n=a("Dd8w"),s=a.n(n),i=a("NYxO"),l=a("0xDb"),o={id:0,taskName:"",taskContent:"",finishTime:"",user:"",taskStatus:"",taskPerson:""},r={page:0,size:999,projection:"all",taskName:""},u=[{value:"未完成"},{value:"已完成"}];e.a={data:function(){return{loading:!1,dialogFormVisible:!1,dialogStatus:"",searchForm:a.i(l.e)(r),textMap:{update:"编辑",create:"创建"},formData:a.i(l.e)(o),blueLabel:{},taskStatusOptions:u,checkPersonOptions:[]}},computed:s()({},a.i(i.b)(["menus","inspectionTasks","blueLabels","selectedBlueLabel","selectedInspectionTask","users"])),mounted:function(){this.selectedBlueLabel&&this.selectedBlueLabel.id&&(this.blueLabel=this.selectedBlueLabel),this.query()},watch:{menus:function(){var t=this.$route.query.id,e=this.menus.filter(function(e){return e.id===parseInt(t)});e.length&&(this.blueLabel=e[0])}},methods:s()({},a.i(i.c)(["createInspectionTask","updateInspectionTask","deleteInspectionTask","queryAllInspectionTasks","queryAllUsers"]),{query:function(){var t=this;this.loading=!0,this.queryAllInspectionTasks(this.searchForm).then(function(){t.loading=!1}).catch(function(e){console.log(e),t.loading=!1})},handleCreate:function(){this.formData=a.i(l.e)(o),this.dialogStatus="create",this.dialogFormVisible=!0,this.queryUser()},queryUser:function(){var t=this;this.queryAllUsers().then(function(){t.loading=!1;var e=t.users;if(e.length>0){for(var a=[],n=0;n<e.length;n++){var s=e[n],i=s.userName,l=s.id,o={label:i,value:l};a.push(o)}t.checkPersonOptions=a}}).catch(function(e){console.log(e),t.loading=!1})},create:function(){var t=this;this.$refs.inspectionTaskForm.validate(function(e){if(e){t.loading=!0,t.createAndUpdate();var n={pid:t.selectedBlueLabel.id,inspectionTask:t.formData,blueLabel:t.blueLabels};t.createInspectionTask(n).then(function(e){a.i(l.d)(),t.dialogFormVisible=!1,t.loading=!1,t.query()}).catch(function(e){a.i(l.d)("",{type:"error"}),t.loading=!1})}})},createAndUpdate:function(){for(var t=this.formData,e=this.checkPersonOptions,a=t.finishTime,n=t.taskStatus,s=t.taskPerson,i=t.taskName,l=t.taskContent,o="",r=0;r<e.length;r++){var u=e[r];u.value===s&&(o=u.label)}if("undefined"===t.id){var c={finishTime:a,taskStatus:n,taskContent:l,taskName:i,user:"userId/"+s,taskPerson:o};this.formData=c}else{var d=t.id,f={id:d,finishTime:a,taskStatus:n,taskContent:l,taskName:i,user:"userId/"+s,taskPerson:o};this.formData=f}},handleUpdate:function(t){this.formData=a.i(l.e)(t),this.dialogStatus="update",this.dialogFormVisible=!0,this.queryUser()},update:function(t){var e=this;this.loading=!0,this.createAndUpdate(),this.updateInspectionTask(this.formData).then(function(){e.dialogFormVisible=!1,e.loading=!1,t||a.i(l.d)(),e.query()}).catch(function(n){t||a.i(l.d)("",{type:"error"}),e.loading=!1})},openHandleDelete:function(t){var e=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){e.deleteInspectionTask(t).then(function(){a.i(l.d)(),e.query()}).catch(function(t){a.i(l.d)("",{type:"error"})})}).catch(function(){a.i(l.d)("已取消删除",{type:"info"})})}})}}});